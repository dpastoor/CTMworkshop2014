## Framing the workshop

### Over the course of this workshop we want to use R to:

* Load some data
* calculate basic summary statistics
* visualize the data
* prepare the data for modeling
* modify the data to use for simulations

To do that we'll need to learn some **programming**

### Objectives
* Explain what a library/package is, and what they are used for.
* Load an R library and use the things it contains.
* Learn where to get help
* Read tabular data from a file into a program.
* Assign values to variables.
* Learn about data types

## Getting Started

While we start the overview of R we wanted to make sure everyone has the necessary components set-up for R use. Please open the **setup.R** file and we will show everyone how to run the code. If you have any problems please put up a **RED** sticky and a helper will come assist

--- 

## R Vocabulary
- **packages** are add on features to R that include data, new functions and methods, and extended capabilities. Think of them as ``apps'' on your phone. We've already installed several!
- **terminal** this is the main window of R where you enter commands
- **scripts** these are where you store commands to be run in the terminal later, like syntax files in SPSS or .do files in Stata
- **functions** commands that do something to an object in R
- **data frame** the main data structure used in data analysis, an object with rows and columns that includes numbers, factors, and other data types
- **workspace** the working memory of R where all objects are stored
- **vector** the basic unit of data in R
- **symbols** used to name and store objects or to designate operations/functions
- **attributes** determine how functions act on objects

---

## Components of an R Setup
- **R** - R works in the command line of any OS, but also comes with a basic GUI to operate on its own in Windows and Mac [download](http://cran.r-project.org/)
- **RStudio** - a much better way to work in R that allows editing of scripts, operation of R, viewing of the workspace, and R help all on one screen [download](http://rstudio.org/download/)

---

## Rstudio

The R workspace in RStudio

[! R workspace][img/workspacescreen.png]



---

## Let's Look at RStudio
- RStudio has made R more accessible and easy to use than ever!
- 4 panels, various tabs
- Help, plots, file structure
- Workspace, history, version control
- Working files
- The R Console

---

## Self-help
- Let's see, type: `?summary`
- For tricky questions, funky error messages (there are many), and other issues, use Google (include "in R" to the end of your query)
- We can also use [RSeek](http://www.rseek.org/) - the search engine just for R!
- [StackOverflow](http://www.stackoverflow.com) has become a great resource with many questions for many specific packages in R, and a rating system for answers
- A number of R Core members contribute there

---

## Self-help (2)
- Sometimes R Help can be a bit prickly and unfriendly...
- The most important part of getting help is being able to ask your question with a reproducible example (i.e. some short simulated data and code that doesn't do what you want)
- Like this:

```{r echo=TRUE, message=FALSE, warning=FALSE}
Dose <- c(0.1, 0.1, 0.1)
Weight <- c(52, "12", 38)
#Trying to calculate amount to give for weight-based dosing
Dose*Weight
```

In this case, someone could replicate it, allowing them to notice that the '12' is a character rather than numeric and point it out.

- For R Help etiquette (for the tough problems) see [the great advice here](http://adv-r.had.co.nz/Reproducibility.html)


---


## R As A Calculator

```{r computing, eval = FALSE}
2+2 ## add numbers
2*pi #multiply by a constant
7+runif(1,min=0,max=1) #add a random variable
4^4 # powers
sqrt(4^4) # functions
```

---

## Arithmetic Operators
- In addition to the obvious `+` `-` `=` `/` `*` and exponential `^`, there is also integer division `%/%` and remainder in integer division (known as modulo arithmetic) `%%`
```{r arithmetic, eval = FALSE}
2+2
2/2
2*2
2^2
2==2
23 %/% 2 
23 %% 2
```

---

## Other Key Symbols
- `<-` is the assignment operator, it declares something is something else
```{r}
ID <-3
ID
TRT <- "placebo"
TRT
```

--- 
## Other Key Symbols (II)
- `:` is the sequence operator
```{r}
1:10
# it increments by one
a<-100:120
a
```
- **This is handy**

---
## Sequence and Repeat
Can have more fine control
```{r}
#seq(from #, to #, by increment)
seq(0, 24, 0.5)

#rep (values to repeat, # of times to repeat, ...)
rep(c('a', 'b'), 3)
```

---

## Comments in R
- **#** denotes a comment in R
- Anything after the **#** is not evaluated and ignored in R
- This is handy for making things reproducible

```{r poundsigns,eval=FALSE,echo=TRUE,tidy=FALSE}

# weight of female adults patients in kg
weight <- c(46.3, 51, 42)


```

---

## R Advanced Math
- R also supports advanced mathematical features and expressions
- R can take integrals and derivatives and express complex functions
- Easiest of all, R can generate distributions of data very easily

  - e.g. `rnorm(100)` or `rbinom(100)`

- This comes in handy when writing examples and building analyses because it is trivial to generate a synthetic piece of data to use as an example
- Try typing `hist(rnorm(10000))`

---

## Using the Workspace
- To do more we need to learn how to manipulate the 'workspace'.
- This includes all the vectors, datasets, and functions stored in memory.
- All R objects are stored in the memory of the computer, limiting the available space for calculation to the size of the RAM on your machine.
- R makes organizing the workspace easy.

---

## Using the Workspace (2)
```
x<-5 #store a variable with <-
x    #print the variable
z<-3 
ls() #list all variables
ls.str() #list and describe variables
rm(x)    # delete a variable
ls()
```
You can also also visually see what is in your workspace in Rstudio

---

## R as a Language
- R is more than statistical software, it is a computer language
- Like any language it has rules (some poorly enforced), and conventions
- Case sensitivity matters
```{r}
a<-3
A<-4
print(c(a,A))
```
   <font color="red">**a** &#8800; **A**</font> 
2. What happens if I type **print(a,A)**?

---

## Concatenating with `c`
- So what does **c** do?
```{r}
A<-c(3,4)
print(A)
```
- `c` stands for concatenate and allows vectors to have multiple elements
- If you ever need two elements in a vector, you need to wrap it up in `c`, which is one of the most used functions you will ever use
- `c` is important to put any vector together, but remember that *objects within a vector must all be of the same type*

## Some Other Language ~~Bugs~~ Features
- R is maddeningly inconsistent in it's naming conventions
  * Some functions are `camelCase`; others `are.dot.separated`; others `use_underscores`
  * Function results are stored in a variety of ways across function implementations
  * R has multiple graphics packages that different functions use for default plot construction (`base`, `grid`, `lattice`, and `ggplot2`)
  * R has multiple packages and functions to do the same analysis as well, though some standardization has started to occur
  * Be flexible and be aware of R's flexibility


---

## Special Operators
- The comparison operators `<`, `>`, `<=`, `>=`, `==`, and `!=` are used to compare values across vectors
```{r vectorcomp}
big<-c(9,12,15,25)
small<-c(9,3,4,2)
# Give us a nice vector of logical values
big>small
big=small
# Oops--don't do this, reassigns big to small
print(big)

```
- Comparison operators can be tricky, so to keep it straight never use `=` or `==` to assign anything, always use `<-`



## Special operators (II)
- The logical operators `|` (or) and `&` (and) can be used to combine two logical values and produce another logical value as the result. The operator `!` (not) negates a logical value. These operators allow complex conditions to be constructed.
```{r vectorlogic}
foo<-c(NA,4,9,8.7)
!is.na(foo) # Returns TRUE for non-NA
a <-foo[!is.na(foo)]
a
```


## Data Structures in R
- R has a number of basic data classes as well as arbitrary specialized object types for various purposes
- **vectors** are the basic data class in R and can be thought of as a single column of data (even a column of length 1)
- **matrices and arrays** are rows and columns of all the same mode data
- **data frames** are rows and columns where the columns can represent different data types
- **lists** are arbitrary combinations of disparate object types in R

---

## R for Pharmacometricians

- Data Handling
- Data Manipulation
  - Some Frequent Tasks
- Plotting
- Reporting

The rest of this presenation will be example-driven, and will often draw on the <x> dataset provided or the built-in R datasets

---
## Reading in Data

Data from a variety of formats an be read into R - two of the most common are .tab and .csv

Lets read in the dataset:
```{r}
data <- data(Theoph)
head(data)
```

---
We can quickly find additional information about the dataset
```{r}
# What are the column names?
names(data)
# how long is the dataset - did everything read in correctly?
nrow(data)
# numer of columns
ncol(data)
```

---

```{r}
#What is the structure of each column
str(data)
```


We can get some summary statistics

```{r}
summary(data)
```


---

## Working with data frames
class(data)

- Data frames are uniform in shape and information inside a column - this makes it easy to work with!
- **[ ]**'s are an easy way to get to certain parts of a data frame
- A data frame is written as: **data[row, column]**

```{r}
data[2,]
head(data[,2], n = 10)
```

---
## Columns using $

Can easily call on or manipulate a single column via **dataframe$colname**


```{r}
head(data$AMT)
unique(data$TIME)
```

--- 
## POP QUIZ

How can easily check the number of unique individuals in the dataset using what we've learned so far?

---

## ANSWER
```{r}
length(unique(data$CID))
```

--- 
