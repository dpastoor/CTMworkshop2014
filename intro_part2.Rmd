```{r}
library(PKPDdatasets)
data <- sd_oral_richpk
names(data) <- toupper(names(data))
```

---

## Accessing columns using $

Can easily call on or manipulate a single column via **dataframe$colname**


```{r}
head(data$AMT)
unique(data$TIME)
```

---
## Accessing information using **Indexing**

The index is the way that the information can be referenced in the dataframe

* remember **df[row,column]**

```{r}
data[2,]
head(data[,2], n = 16)
```

--- 

## Subsetting

Can easily subset rows of the data frame using the <font color="red">[ ]</font> in combination with <font color="red">$ </font>
```{r}
ID1 <- data[data$ID == 1,]
ID1
```

---
## Subsetting (II)
Or can take only a subset of columns
```{r}
datasmall <- data[, c(1:4)]
```

or using the column names

```{r}
keepcols <- c("ID", "TIME", "CONC", "AMT")
datasmall <- data[, keepcols]
head(datasmall)
```

---
## Using both together
```{r}

keepcols <- c("CID", "TIME", "CONC", "AMT")
ID1 <- data[data$CID == 1, keepcols]
head(ID1)
```

---
## Multiple subsets

You can also use the **&** and **|** operators to do multiple subsets at once

Let's make a dataset with only males less than 40 years old

```{r}
youngmales <- data[data$ISM != 0 & data$AGE <= 40,]
head(youngmales[!duplicated(youngmales$CID),])
```

---
## Your Turn
* Subset the dataset into males and females
* Get the summary information for weight for:
  * all individuals
  * and males and females separately
* Challenge:
  * how many black females and asian males are there? subset out only those groups

---
## Challenge Answer
```{r}
head(data[(data$RACE == "Black" & data$GENDER == "Female") | (data$RACE == "Asian" & data$GENDER == "Male"),])
```


---
## Subsetting to assign values

What if we needed to change all the 0's in the AMT column to NA values
```{r}
# so we can keep the original dataset
changedata <- data
head(changedata, n = 3)
changedata[changedata$AMT == 0, "AMT"] <- NA
head(changedata, n = 3)
## or
changedata$AMT[changedata$AMT ==0] <- NA
```

---

## Understanding (logical) subsetting

**Live demo**

---
## Adding Columns to a DF with **$**
```{r}
# find the mean age and add it to new column
data$MEANAGE <- mean(data$AGE)
head(data, n= 3)
```

```{r, include = FALSE}
# can also delete columns
data$MEANAGE <- NULL
head(data, n = 3)
```

---
## Transforming data

What if we wanted time to be in minutes rather than hours
```{r}
data$TIMEMIN <- data$TIME*60
head(data)
```

```{r}
data$TIMEMIN <- NULL
```
